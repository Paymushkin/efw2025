# Как проверить production build локально (как на Vercel)

## Почему на Vercel проблемы, а локально все хорошо?

### Различия между dev и production:

1. **Режим разработки (`npm run dev`)**:
   - SSR работает упрощенно
   - Клиентские библиотеки (Swiper) инициализируются проще
   - Меньше строгих проверок гидратации
   - Нет оптимизаций production

2. **Production на Vercel**:
   - Полный SSR: компоненты рендерятся на сервере
   - На сервере нет `window`, `document`, браузерных API
   - Строгая гидратация: HTML сервера должен совпадать с клиентом
   - Другая среда сборки и оптимизации

## Как проверить локально production build:

### Вариант 1: Использовать специальный скрипт (рекомендуется)
```bash
npm run preview:local
```

Этот скрипт:
1. Временно меняет preset на `node-server` (для поддержки preview)
2. Собирает production build
3. Запускает preview сервер
4. Восстанавливает оригинальный preset `vercel`

### Вариант 2: Использовать Vercel CLI (если установлен)
```bash
# Установить Vercel CLI
npm i -g vercel

# Запустить локальный сервер с production build
vercel dev
```

### Вариант 3: Проверить на Vercel Preview
После каждого коммита Vercel создает preview deployment - проверьте там.

**Важно:** Стандартный `npm run preview` не работает с preset `vercel` - используйте `npm run preview:local` вместо этого.

### Шаг 3: Проверить проблемы
- Откройте DevTools (F12)
- Проверьте консоль на ошибки
- Проверьте, нет ли дублирующихся `id` в HTML
- Проверьте, правильно ли работают карусели

## Что было исправлено:

1. **Обернул `ProgramSection` и `DesignersSection` в `ClientOnly`** - чтобы избежать проблем с SSR
2. **Убрал дублирующиеся `id`** - теперь все `id` находятся только в обертках в `pages/index.vue`
3. **Добавил fallback для компонентов** - чтобы на сервере отображались правильные заголовки

## Полезные команды:

```bash
# Собрать production build для Vercel
npm run build

# Запустить preview локально (с автоматическим изменением preset)
npm run preview:local

# Очистить build и пересобрать
rm -rf .nuxt .output .vercel
npm run build
npm run preview:local

# Или использовать Vercel CLI (если установлен)
vercel dev
```

## Рекомендации:

1. **Для быстрой проверки**: Используйте `npm run preview:local` - это покажет, как будет выглядеть на production
2. **Для финальной проверки**: После коммита проверьте preview deployment на Vercel - там будет точно такая же среда, как на production
3. **Для отладки SSR**: Используйте DevTools → Network → откройте исходный HTML (View Source) - там видно, что отдал сервер

## Отладка SSR проблем:

1. Проверьте консоль браузера на ошибки гидратации
2. Проверьте HTML источник страницы (View Source) - там должен быть правильный HTML от сервера
3. Используйте `ClientOnly` для компонентов, которые используют браузерные API
4. Проверяйте, что `id` уникальны в HTML

